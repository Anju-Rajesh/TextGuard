{% extends "layout.html" %}
{% block content %}
<header>
    <h1>AI <span>Detection</span></h1>
    <p>Analyze text to determine if it was generated by Artificial Intelligence.</p>
</header>

<div class="card">
    <div class="card-header">
        <h3>Submit Text for Analysis</h3>
    </div>

    <form method="POST" enctype="multipart/form-data" id="analysisForm">
        <div class="form-group">
            <div class="form-header">
                <label for="text">Text Analysis</label>
                <div class="upload-btn-compact" onclick="document.getElementById('file').click()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v4" />
                        <polyline points="17 8 12 3 7 8" />
                        <line x1="12" y1="3" x2="12" y2="15" />
                    </svg>
                    <span>Upload .txt</span>
                    <span id="fileNamePill" class="file-name-pill"></span>
                </div>
                <input type="file" name="file" id="file" accept=".txt" style="display: none;"
                    onchange="updateFileName(this)">
            </div>
            <textarea name="text" id="text" placeholder="Paste your text here for deep analysis..."></textarea>
        </div>

        <button type="submit" class="btn btn-primary">Start AI Analysis</button>
    </form>
</div>

{% if result %}
<div class="card result-card">
    <div class="result-content">
        <div class="score-container">
            <div class="circular-progress"
                style="background: conic-gradient(var(--primary-color) {{ result.probability * 3.6 }}deg, rgba(255,255,255,0.1) 0deg)">
                <div
                    style="position: absolute; width: 110px; height: 110px; background: var(--bg-color); border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 1;">
                    <span>{{ result.probability }}%</span>
                </div>
            </div>
            <p style="font-weight: 600; margin-top: 0.5rem;">AI Probability</p>
        </div>

        <div class="result-info">
            <h2 style="margin-bottom: 0.5rem;">Analysis Conclusion</h2>
            <div class="badge {% if result.probability > 50 %}badge-danger{% else %}badge-success{% endif %}"
                style="margin-bottom: 1rem; display: inline-block;">
                {{ result.conclusion }}
            </div>
            <p style="color: var(--text-muted);">Our transformer-based model has analyzed the linguistic patterns,
                perplexity, and burstiness of the submitted text to reach this conclusion.</p>
        </div>
    </div>
</div>
{% endif %}

<script>
    function updateFileName(input) {
        const pill = document.getElementById('fileNamePill');
        if (input.files && input.files[0]) {
            pill.textContent = input.files[0].name;
            pill.style.display = 'inline-block';
        } else {
            pill.style.display = 'none';
        }
    }
</script>
{% endblock %}













